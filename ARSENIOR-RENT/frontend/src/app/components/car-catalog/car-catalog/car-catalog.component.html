<app-navbar></app-navbar>

<main class="min-h-screen bg-gray-50">
  
  <!-- Header -->
  <section class="bg-white border-b border-gray-200 py-12">
    <div class="container-custom">
      <h1 class="font-playfair text-center mb-4">Nuestro Catálogo</h1>
      <div class="divider"></div>
      <p class="text-center text-gray-600 max-w-2xl mx-auto">
        Explora nuestra selección de vehículos premium. Cada uno mantenido con los más altos estándares de calidad.
      </p>
    </div>
  </section>

  <!-- Filters -->
  <section class="bg-white border-b border-gray-200 py-6">
    <div class="container-custom">
      <div class="flex flex-col md:flex-row gap-4 items-end">
        
        <!-- Segment Filter -->
        <div class="flex-1">
          <label for="segment" class="text-xs">Categoría</label>
          <select
            id="segment"
            [(ngModel)]="selectedSegment"
            (change)="applyFilters()"
            class="w-full"
          >
            <option value="">Todas</option>
            <option value="A">Premium (A)</option>
            <option value="B">Standard (B)</option>
            <option value="C">Basic (C)</option>
          </select>
        </div>

        <!-- Transmission Filter -->
        <div class="flex-1">
          <label for="transmission" class="text-xs">Transmisión</label>
          <select
            id="transmission"
            [(ngModel)]="selectedTransmission"
            (change)="applyFilters()"
            class="w-full"
          >
            <option value="">Todas</option>
            <option value="Automática">Automática</option>
            <option value="Manual">Manual</option>
          </select>
        </div>

        <!-- Seats Filter -->
        <div class="flex-1">
          <label for="seats" class="text-xs">Asientos Mínimos</label>
          <select
            id="seats"
            [(ngModel)]="selectedSeats"
            (change)="applyFilters()"
            class="w-full"
          >
            <option value="">Todos</option>
            <option value="2">2+</option>
            <option value="4">4+</option>
            <option value="5">5+</option>
            <option value="7">7+</option>
          </select>
        </div>

        <!-- Clear Button -->
        <button (click)="clearFilters()" class="btn-ghost">
          Limpiar Filtros
        </button>
      </div>
    </div>
  </section>

  <!-- Cars Grid -->
  <section class="section-padding">
    <div class="container-custom">
      
      @if (loading()) {
        <app-loading-spinner [size]="300" message="Cargando catálogo..."></app-loading-spinner>
      }

      @if (error()) {
        <div class="error-message text-center">
          {{ error() }}
        </div>
      }

      @if (!loading() && filteredCars().length === 0) {
        <div class="text-center py-16">
          <p class="text-gray-600 text-lg">No se encontraron vehículos con los filtros seleccionados.</p>
          <button (click)="clearFilters()" class="btn-primary mt-6">
            Ver Todos los Vehículos
          </button>
        </div>
      }

      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
        @for (car of filteredCars(); track car.id) {
          <div class="card group cursor-pointer" [routerLink]="['/car', car.id]">
            
            <!-- Image -->
            <div class="aspect-[4/3] bg-gray-200 mb-4 overflow-hidden">
              @if (car.image) {
                <img [src]="car.image" [alt]="car.brand + ' ' + car.model" 
                     class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-500" />
              } @else {
                <div class="w-full h-full flex items-center justify-center text-gray-400">
                  Sin imagen
                </div>
              }
            </div>

            <!-- Segment Badge -->
            <div class="mb-3">
              <span class="badge">{{ getSegmentLabel(car.segment) }}</span>
            </div>

            <!-- Title -->
            <h3 class="font-playfair mb-2">{{ car.brand }} {{ car.model }}</h3>
            <p class="text-sm text-gray-600 mb-4">{{ car.year }}</p>

            <!-- Rating -->
            <div class="flex items-center gap-1 mb-4">
              @for (star of getStarRating(car.rating); track $index) {
                <span class="text-black">{{ star }}</span>
              }
              <span class="text-sm text-gray-600 ml-2">
                ({{ car.totalRatings }} reseñas)
              </span>
            </div>

            <!-- Features -->
            <div class="flex items-center gap-4 text-sm text-gray-600 mb-4">
              <span>{{ car.transmission }}</span>
              <span>•</span>
              <span>{{ car.seats }} asientos</span>
              <span>•</span>
              <span>{{ car.fuelType }}</span>
            </div>

            <!-- Price -->
            <div class="border-t border-gray-200 pt-4">
              <p class="text-2xl font-playfair">${{ car.pricePerDay }}<span class="text-sm text-gray-600">/día</span></p>
            </div>

            <!-- Status -->
            @if (car.status !== 'disponible') {
              <div class="mt-3">
                <span class="badge badge-warning">
                  {{ car.status === 'rentado' ? 'Rentado' : 'Mantenimiento' }}
                </span>
              </div>
            }
          </div>
        }
      </div>
    </div>
  </section>
</main>

<app-footer></app-footer>